"use strict";function AngularFire(e,t,n,r){this._q=e;this._parse=t;this._timeout=n;this._initial=true;this._remoteValue=false;if(typeof r==="string"){this._fRef=new Firebase(r)}else{this._fRef=r}}angular.module("firebase",[]).value("Firebase",Firebase);angular.module("firebase").factory("angularFire",["$q","$parse","$timeout",function(e,t,n){return function(r,i,s,o){var u=new AngularFire(e,t,n,r);return u.associate(i,s,o)}}]);AngularFire.prototype={associate:function(e,t,n){var r=this;var i=this._q.defer();var s=i.promise;if(typeof n==="undefined"){n=[]}this._fRef.on("value",function(s){var o="Error: type mismatch";var u=false;if(i){u=i;i=false}r._remoteValue=n;if(s&&s.val()!==undefined){var a=s.val();if(typeof a!==typeof n){r._log(o);return}var f=Object.prototype.toString;if(f.call(n)!==f.call(a)){r._log(o);return}r._remoteValue=angular.copy(a);if(angular.equals(a,r._parse(t)(e))){return}}r._timeout(function(){r._resolve(e,t,u,r._remoteValue)})});return s},_resolve:function(e,t,n,r){this._parse(t).assign(e,angular.copy(r));this._remoteValue=angular.copy(r);if(n){n.resolve(r);this._watch(e,t)}},_watch:function(e,t){var n=this;e.$watch(t,function(){if(n._initial){n._initial=false;return}var r=JSON.parse(angular.toJson(n._parse(t)(e)));if(angular.equals(r,n._remoteValue)){return}n._fRef.ref().set(r)},true)},_log:function(e){var t=window.console=window.console||{};t.log=function(){};t.log(e)}};angular.module("firebase").factory("angularFireCollection",["$timeout",function(e){function t(e,t){this.$ref=e.ref();this.$id=e.name();this.$index=t;angular.extend(this,{priority:e.getPriority()},e.val())}return function(n,r){function u(e){return e?s[e]+1:0}function a(e,t){s[t.$id]=e;i.splice(e,0,t)}function f(e){var t=s[e];i.splice(t,1);s[e]=undefined}function l(e,t){i[e]=t}function c(e,t,n){i.splice(e,1);i.splice(t,0,n);h(e,t)}function h(e,t){var n=i.length;t=t||n;if(t>n){t=n}for(var r=e;r<t;r++){var o=i[r];o.$index=s[o.$id]=r}}var i=[];var s={};var o;if(typeof n==="string"){o=new Firebase(n)}else{o=n}if(r&&typeof r==="function"){o.once("value",r)}o.on("child_added",function(n,r){e(function(){var e=u(r);a(e,new t(n,e));h(e)})});o.on("child_removed",function(t){e(function(){var e=t.name();var n=s[e];f(e);h(n)})});o.on("child_changed",function(n,r){e(function(){var e=s[n.name()];var i=u(r);var o=new t(n,e);l(e,o);if(i!==e){c(e,i,o)}})});o.on("child_moved",function(t,n){e(function(){var e=s[t.name()];var r=u(n);var o=i[e];c(e,r,o)})});i.add=function(e,t){var n;if(!t){n=o.ref().push(e)}else{n=o.ref().push(e,t)}return n};i.remove=function(e){var t=angular.isString(e)?i[s[e]]:e;t.$ref.remove()};i.update=function(e){var t=angular.isString(e)?i[s[e]]:e;var n={};angular.forEach(t,function(e,t){if(t.indexOf("$")!==0){n[t]=e}});t.$ref.set(n)};return i}}])
